<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recuperar Anota√ß√µes - iPhone</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: rgba(20, 35, 45, 0.95);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #00FFE0;
            margin-bottom: 20px;
            text-align: center;
            font-size: 24px;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }
        .status.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
            color: #10B981;
        }
        .status.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #EF4444;
        }
        .status.info {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.5);
            color: #3B82F6;
        }
        .btn {
            background: linear-gradient(135deg, #00FFE0 0%, #00D4AA 100%);
            color: #0f2027;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 224, 0.4);
        }
        .btn:active {
            transform: translateY(0);
        }
        .instructions {
            background: rgba(0, 206, 209, 0.1);
            border-left: 3px solid #00FFE0;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            font-size: 14px;
            line-height: 1.6;
        }
        .instructions ol {
            margin-left: 20px;
            margin-top: 10px;
        }
        .instructions li {
            margin-bottom: 8px;
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
        .log-item {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }
        .log-item.success { background: rgba(16, 185, 129, 0.1); }
        .log-item.error { background: rgba(239, 68, 68, 0.1); }
        .log-item.info { background: rgba(59, 130, 246, 0.1); }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± Recuperar Anota√ß√µes</h1>
        
        <div id="status" class="status info">
            ‚è≥ Pronto para recuperar...
        </div>
        
        <div class="instructions">
            <strong>üìã Instru√ß√µes:</strong>
            <ol>
                <li>Esta p√°gina vai recuperar suas 16 anota√ß√µes automaticamente</li>
                <li>Clique no bot√£o abaixo para iniciar</li>
                <li>Ap√≥s recuperar, abra o app VRVS e recarregue a p√°gina</li>
                <li>Suas anota√ß√µes devem aparecer na aba "Caderno"</li>
            </ol>
        </div>
        
        <button class="btn" onclick="recuperarAnotacoes()">
            üîÑ RECUPERAR ANOTA√á√ïES AGORA
        </button>
        
        <div id="log" class="log" style="display: none;"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            logDiv.style.display = 'block';
            const item = document.createElement('div');
            item.className = `log-item ${type}`;
            item.textContent = message;
            logDiv.appendChild(item);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function atualizarStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        function recuperarAnotacoes() {
            atualizarStatus('üîÑ Recuperando anota√ß√µes...', 'info');
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
            log('üö® INICIANDO RECUPERA√á√ÉO DE ANOTA√á√ïES...');
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
            
            try {
                // CSV completo com todas as anota√ß√µes
                const csv = `id,temaId,area,tema,conteudo,ultimaAtualizacao,observacoes,sugestao
1762463481961,1762044621730,Trauma MMSS,Fratura de √ömero proximal,"HOT TOPICS üî• 
1) Epidemiologia 
2) Mecanismos de trauma e padr√µes da fratura
3) Classifica√ß√£o Neer e AO
4) Crit√©rios de Hertel",2025-11-22,,
1762821455592,1762813819589,Trauma Ped,Fratura de Condilos,"Hot Topics üî•

C√îNDILOS
1) Complica√ß√µes da fratura do c√¥ndilo lateral 

2) Classifica√ß√£o de Jakob e tratamento

LUXA√á√ÉO 
1) Fratura e les√£o mais associada na luxa√ß√£o do cotovelo

2) Desvios na luxa√ß√£o do cotovelo

EPIC√îNDILOS 
1) Epidemiologia",2025-11-21,,
1762954899298,1762906440957,Trauma Ped,Fraturas do antebra√ßo,Hiperprona√ß√£o = Monteggia ou Galeazzi,2025-11-18,,
1763402721978,1763402713142,Trauma MMII,Fratura de ossos da perna,"Hot topics üî• 

1) Les√µes associadas

2) Desvios aceit√°veis 

3) Complica√ß√µes e diferen√ßas de cada tipo de acesso: infra x supra patelar

4) Ponto de entrada da hastes e seus desvios 

 5) vantagens e desvantagens da HIM fresada.",2025-11-17,,
1763423352500,1763422448208,Oncologia,Introdu√ß√£o aos Tumores,"Tumores que apresentam c√©lulas gigantes 
(1) TGC
(2) Condroblastoma
(3) COA
(4) Osteossarcoma Telangect√°sico
(5) TU Paget
(6) TU Marrom

Tumores Radiossensiveis = TU Pequenas cels azuis
(2) Ewing
(3) Linfoma 
(4) Granuloma Eosinof√≠lico
(5) Mieloma 
(6) Carcinomas metast√°ticos",2025-11-18,,
1763503973804,1763501176586,Coluna,Espondilolistese,"Hot Topics üî• 
1) Classifica√ß√£o de Wiltze
2) Caracter√≠sticas de cada tipo
3) T√©cnica de Gill",2025-11-19,,
1763673272333,1763669330752,Ciencias Basicas,Osteomielite,"Na d√∫vida: Chuta Pseudomonas, marca tipo 4 de roberts(sarcoma de Ewing) ou tipo 5(Condroblastoma) üòÇ

HOT TOPICS üî• ü•µ
1) Correlacionar agentes etiol√≥gicos com o tipo de infec√ß√£o(forma de contamina√ß√£o ou perfil do paciente), ex: usu√°rio de drogas, anemia falciforme‚Ä¶

2) Correlacionar classifica√ß√£o de Gledhill-Roberts com Dx Diferenciais 

3) Diferen√ßas entre osteomielite de coluna e Discite

4) Espondilodiscite tem que saber epidemiologia e fisiopatologia",2025-12-02,,
1763849465874,1763845574661,Trauma Ped,Fraturas da T√≠bia,"HOT TOPICS üî•
T√çBIA PROXIMAL(met√°fise)
1) Epidemiologia
 ‚Ä¢ Idade = 3-6 anos
 ‚Ä¢ Mecanismo de trauma =  Trauma lateral com Joelho em EXT + Valgo

Fratura fis√°ria 
 ‚Ä¢ Fgmto TH posterior = trauma hiper flex√£o-> reduz em EXT
 ‚Ä¢ Fgmto TH anterior = trauma hiper extens√£o -> reduz em FL

FRATURA DA TAT
 1) Epidemiologia
 ‚Ä¢ Mais comum em meninos um pouco mais velhos(13-16 anos)
 ‚Ä¢ Mecanismo: contra√ß√£o brusca do quadr√≠ceps -> EXT for√ßada contra resist√™ncia(salto com impuls√£o violenta)

2) Correla√ß√£o entre as classifica√ß√µes de SH e Watson Jones
 ‚Ä¢ Fratura da TAT com envolvimento articular e les√£o do centro de ossifica√ß√£o prim√°rio = tipo 3 de Watson Jones

FRATURA DA ESPINHA
 1) Mecanismo de trauma: VALGO ou HIPER EXT + Rota√ß√£o LATERAL do joelho

2) Classifica√ß√£o de Meyrs e McKeever
 Tipo 1 -> conservador 
 Tipo 2 -> tend√™ncia a tto conservador 
 Tipo 3 -> tend√™ncia a tto cir√∫rgico 
 Tipo 4 -> cir√∫rgico 

COMPLICA√á√ïES  GERAIS 
(1) F√™mur distal = Valgo
(2) T√≠bia proximal = Valgo(Cozen)
   ‚Ä¢ melhora espontaneamente ap√≥s 4 anos da les√£o(tto conservador)
   ‚Ä¢ interposi√ß√£o da pata de ganso
(3) T√≠bia di√°fise = Varo
(4) Espinha da t√≠bia = Perda da extens√£o 
(5) TAT = Recurvato",2025-12-01,,
1763849465874,1763845611548,Trauma Ped,Fraturas do f√™mur,"HOT TOPICS üî• 
 ‚Ä¢ De uma maneira geral os n√∫meros s√£o altos:
  - joelho flutuante a incid√™ncia de fraturas expostas chega a 60%
  - incid√™ncia de fraturas diafisarias chega a 70 %

F√™mur Distal
1) Principal les√£o associada: LCA

F√™mur di√°fise 
1) Tratamento(tipos e indica√ß√µes)
2) Desvantagens da haste com entrada pela fossa do piriforme: (1) fise aberta, (2)risco de fratura do colo e osteonecrose

F√™mur Proximal
1) Classifica√ß√£o de DELBET e COLONNA: mais comum e mais grave",2025-11-30,,
1763999701838,1763941123114,Trauma Ped,fraturas da Bacia,"HOT TOPICS üî• 
1) Classifica√ß√£o de Torode e Zieg
  - fratura dos ramos p√∫bicos bilateral = tipo 4a
 - Anel p√©lvico Anterior √© 3A",2025-11-30,,
1764074226771,1764030788290,Joelho,Osteocondrite dissecante e Les√µes condrais,"HOT TOPICS üî• 
Osteocondrite dissecante 
1) Epidemiologia 
2) Localiza√ß√£o 
3) Osteocondrite da patela: progn√≥stico e localiza√ß√£o 

Les√µes condrais 
1) Tipos de tratamento",2025-11-25,,
1764118688167,1764075917874,Joelho,Menisco,"HOT TOPICS üî•

1) Les√£o em RAMPA
 ‚Ä¢ Impacto posteromedial na t√≠bia e no f√™mur.
 ‚Ä¢ Mais comum",2025-11-29,,
1764363615850,1764363603942,Joelho,Les√µes do LCA,"HOT TOPICS üî•

1) Diferen√ßas(vantagens e desvantagens) entre cada tipo de enxerto",2025-11-30,,
1764533467862,1764528772802,Joelho,ATJ e Gonartrose,"HOT TOPICS üî•

ATJ
1) Infec√ß√£o

2) A CONTRAINDICA√á√ÉO ABSOLUTA QUE ELES QUEREM: 
  -> DISFUN√á√ÉO DO MECANISMO EXTENSOR.

UNICOMPARTIMENTAL
7 Contraindica√ß√µes 

 OSTEOTOMIAS
6 Contraindica√ß√µes",2025-12-01,,`;

                log('üìÑ CSV carregado com sucesso');
                
                // Carregar dados do VRVS do localStorage
                const dadosStr = localStorage.getItem('vrvs_dados');
                if (!dadosStr) {
                    throw new Error('Dados do VRVS n√£o encontrados no localStorage. Abra o app VRVS primeiro!');
                }
                
                const dados = JSON.parse(dadosStr);
                log(`‚úÖ ${dados.length} temas encontrados no VRVS`);
                
                // Parse CSV melhorado (preserva quebras de linha dentro de aspas)
                function parseCSVCompleto(text) {
                    const lines = [];
                    let currentLine = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < text.length; i++) {
                        const ch = text[i];
                        const next = text[i + 1];
                        
                        if (ch === '"') {
                            if (inQuotes && next === '"') {
                                currentLine += '"';
                                i++;
                            } else {
                                inQuotes = !inQuotes;
                                currentLine += ch;
                            }
                        } else if (ch === '\n' && !inQuotes) {
                            lines.push(currentLine);
                            currentLine = '';
                        } else {
                            currentLine += ch;
                        }
                    }
                    if (currentLine) lines.push(currentLine);
                    
                    // Parse headers
                    const headers = [];
                    let current = '';
                    inQuotes = false;
                    for (let i = 0; i < lines[0].length; i++) {
                        const ch = lines[0][i];
                        if (ch === '"') {
                            if (inQuotes && lines[0][i + 1] === '"') {
                                current += '"';
                                i++;
                            } else {
                                inQuotes = !inQuotes;
                            }
                        } else if (ch === ',' && !inQuotes) {
                            headers.push(current.trim().replace(/^"|"$/g, ''));
                            current = '';
                        } else {
                            current += ch;
                        }
                    }
                    headers.push(current.trim().replace(/^"|"$/g, ''));
                    
                    // Parse rows
                    const rows = [];
                    for (let lineIdx = 1; lineIdx < lines.length; lineIdx++) {
                        const line = lines[lineIdx];
                        const values = [];
                        current = '';
                        inQuotes = false;
                        
                        for (let i = 0; i < line.length; i++) {
                            const ch = line[i];
                            if (ch === '"') {
                                if (inQuotes && line[i + 1] === '"') {
                                    current += '"';
                                    i++;
                                } else {
                                    inQuotes = !inQuotes;
                                }
                            } else if (ch === ',' && !inQuotes) {
                                values.push(current.trim());
                                current = '';
                            } else {
                                current += ch;
                            }
                        }
                        values.push(current.trim());
                        rows.push(values);
                    }
                    
                    return { headers, rows };
                }
                
                log('üîç Parseando CSV...');
                const { headers, rows } = parseCSVCompleto(csv);
                log(`‚úÖ ${rows.length} linhas parseadas`);
                
                const idxId = headers.indexOf('id');
                const idxTemaId = headers.indexOf('temaId');
                const idxArea = headers.indexOf('area');
                const idxTema = headers.indexOf('tema');
                const idxConteudo = headers.indexOf('conteudo');
                const idxData = headers.indexOf('ultimaAtualizacao');
                
                let anotacoes = [];
                let recuperadas = 0;
                
                rows.forEach((row, i) => {
                    let conteudo = row[idxConteudo] || '';
                    // Remover aspas externas se houver
                    if (conteudo.startsWith('"') && conteudo.endsWith('"')) {
                        conteudo = conteudo.slice(1, -1);
                    }
                    // Preservar quebras de linha
                    conteudo = conteudo.replace(/\\n/g, '\n').replace(/\\r/g, '\r');
                    
                    const anotacao = {
                        id: row[idxId] || Date.now() + i,
                        temaId: String(row[idxTemaId] || ''),
                        area: row[idxArea] || '',
                        tema: row[idxTema] || '',
                        conteudo: conteudo,
                        ultimaAtualizacao: row[idxData] || new Date().toISOString().split('T')[0]
                    };
                    
                    // Encontrar temaId se necess√°rio
                    if (!anotacao.temaId || anotacao.temaId.trim() === '') {
                        if (anotacao.tema) {
                            const tema = dados.find(t => String(t.tema).trim() === String(anotacao.tema).trim());
                            if (tema) {
                                anotacao.temaId = String(tema.id);
                                log(`‚úÖ TemaId encontrado para "${anotacao.tema}": ${anotacao.temaId}`, 'success');
                            } else {
                                log(`‚ö†Ô∏è Tema "${anotacao.tema}" n√£o encontrado nos dados`, 'error');
                            }
                        }
                    } else {
                        // Verificar se temaId existe
                        const tema = dados.find(t => String(t.id) === String(anotacao.temaId));
                        if (tema) {
                            anotacao.area = tema.area;
                            anotacao.tema = tema.tema;
                            recuperadas++;
                        } else {
                            log(`‚ö†Ô∏è TemaId ${anotacao.temaId} n√£o encontrado, tentando pelo nome...`, 'info');
                            // Tentar pelo nome
                            const tema = dados.find(t => String(t.tema).trim() === String(anotacao.tema).trim());
                            if (tema) {
                                anotacao.temaId = String(tema.id);
                                anotacao.area = tema.area;
                                anotacao.tema = tema.tema;
                                recuperadas++;
                                log(`‚úÖ TemaId corrigido para "${anotacao.tema}": ${anotacao.temaId}`, 'success');
                            }
                        }
                    }
                    
                    if (anotacao.temaId && anotacao.temaId.trim() !== '') {
                        anotacoes.push(anotacao);
                    }
                });
                
                // Salvar no localStorage
                localStorage.setItem('vrvs_anotacoes', JSON.stringify(anotacoes));
                
                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                log(`‚úÖ ${anotacoes.length} anota√ß√µes recuperadas e salvas!`, 'success');
                log(`‚úÖ ${recuperadas} anota√ß√µes vinculadas a temas existentes`, 'success');
                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                
                atualizarStatus(`‚úÖ ${anotacoes.length} anota√ß√µes recuperadas! Abra o app VRVS e recarregue a p√°gina.`, 'success');
                
            } catch (error) {
                log(`‚ùå ERRO: ${error.message}`, 'error');
                atualizarStatus(`‚ùå Erro: ${error.message}`, 'error');
                
                if (error.message.includes('Dados do VRVS n√£o encontrados')) {
                    log('üí° SOLU√á√ÉO: Abra o app VRVS primeiro, depois volte aqui e tente novamente.', 'info');
                }
            }
        }
        
        // Verificar se j√° tem dados do VRVS
        window.addEventListener('load', () => {
            const dadosStr = localStorage.getItem('vrvs_dados');
            if (dadosStr) {
                log('‚úÖ Dados do VRVS encontrados! Pode recuperar as anota√ß√µes.', 'success');
            } else {
                log('‚ö†Ô∏è Dados do VRVS n√£o encontrados. Abra o app VRVS primeiro!', 'error');
                atualizarStatus('‚ö†Ô∏è Abra o app VRVS primeiro, depois volte aqui!', 'error');
            }
        });
    </script>
</body>
</html>

