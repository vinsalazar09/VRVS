// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RECUPERAÃ‡ÃƒO DIRETA - EXECUTE NO CONSOLE DO NAVEGADOR NO APP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Cole este cÃ³digo NO CONSOLE do navegador quando estiver no app VRVS

(function() {
    console.log('ğŸš¨ RECUPERANDO ANOTAÃ‡Ã•ES DO CSV...');
    
    // CSV que vocÃª anexou
    const csv = `id,temaId,area,tema,conteudo,ultimaAtualizacao,observacoes,sugestao
1762463481961,1762044621730,Trauma MMSS,Fratura de Ãšmero proximal,"HOT TOPICS ğŸ”¥ 
1) Epidemiologia 
2) Mecanismos de trauma e padrÃµes da fratura
3) ClassificaÃ§Ã£o Neer e AO
4) CritÃ©rios de Hertel",2025-11-22,,
1762821455592,1762813819589,Trauma Ped,Fratura de Condilos,"Hot Topics ğŸ”¥

CÃ”NDILOS
1) ComplicaÃ§Ãµes da fratura do cÃ´ndilo lateral 

2) ClassificaÃ§Ã£o de Jakob e tratamento

LUXAÃ‡ÃƒO 
1) Fratura e lesÃ£o mais associada na luxaÃ§Ã£o do cotovelo

2) Desvios na luxaÃ§Ã£o do cotovelo

EPICÃ”NDILOS 
1) Epidemiologia",2025-11-21,,
1762954899298,1762906440957,Trauma Ped,Fraturas do antebraÃ§o,HiperpronaÃ§Ã£o = Monteggia ou Galeazzi,2025-11-18,,
1763402721978,1763402713142,Trauma MMII,Fratura de ossos da perna,"Hot topics ğŸ”¥ 

1) LesÃµes associadas

2) Desvios aceitÃ¡veis 

3) ComplicaÃ§Ãµes e diferenÃ§as de cada tipo de acesso: infra x supra patelar

4) Ponto de entrada da hastes e seus desvios 

 5) vantagens e desvantagens da HIM fresada.",2025-11-17,,
1763423352500,1763422448208,Oncologia,IntroduÃ§Ã£o aos Tumores,"Tumores que apresentam cÃ©lulas gigantes 
(1) TGC
(2) Condroblastoma
(3) COA
(4) Osteossarcoma TelangectÃ¡sico
(5) TU Paget
(6) TU Marrom

Tumores Radiossensiveis = TU Pequenas cels azuis
(2) Ewing
(3) Linfoma 
(4) Granuloma EosinofÃ­lico
(5) Mieloma 
(6) Carcinomas metastÃ¡ticos",2025-11-18,,
1763503973804,1763501176586,Coluna,Espondilolistese,"Hot Topics ğŸ”¥ 
1) ClassificaÃ§Ã£o de Wiltze
2) CaracterÃ­sticas de cada tipo
3) TÃ©cnica de Gill",2025-11-19,,
1763673272333,1763669330752,Ciencias Basicas,Osteomielite,"Na dÃºvida: Chuta Pseudomonas, marca tipo 4 de roberts(sarcoma de Ewing) ou tipo 5(Condroblastoma) ğŸ˜‚

HOT TOPICS ğŸ”¥ ğŸ¥µ
1) Correlacionar agentes etiolÃ³gicos com o tipo de infecÃ§Ã£o(forma de contaminaÃ§Ã£o ou perfil do paciente), ex: usuÃ¡rio de drogas, anemia falciformeâ€¦

2) Correlacionar classificaÃ§Ã£o de Gledhill-Roberts com Dx Diferenciais 

3) DiferenÃ§as entre osteomielite de coluna e Discite

4) Espondilodiscite tem que saber epidemiologia e fisiopatologia",2025-12-02,,
1763849465874,1763845574661,Trauma Ped,Fraturas da TÃ­bia,"HOT TOPICS ğŸ”¥
TÃBIA PROXIMAL(metÃ¡fise)
1) Epidemiologia
 â€¢ Idade = 3-6 anos
 â€¢ Mecanismo de trauma =  Trauma lateral com Joelho em EXT + Valgo

Fratura fisÃ¡ria 
 â€¢ Fgmto TH posterior = trauma hiper flexÃ£o-> reduz em EXT
 â€¢ Fgmto TH anterior = trauma hiper extensÃ£o -> reduz em FL

FRATURA DA TAT
 1) Epidemiologia
 â€¢ Mais comum em meninos um pouco mais velhos(13-16 anos)
 â€¢ Mecanismo: contraÃ§Ã£o brusca do quadrÃ­ceps -> EXT forÃ§ada contra resistÃªncia(salto com impulsÃ£o violenta)

2) CorrelaÃ§Ã£o entre as classificaÃ§Ãµes de SH e Watson Jones
 â€¢ Fratura da TAT com envolvimento articular e lesÃ£o do centro de ossificaÃ§Ã£o primÃ¡rio = tipo 3 de Watson Jones

FRATURA DA ESPINHA
 1) Mecanismo de trauma: VALGO ou HIPER EXT + RotaÃ§Ã£o LATERAL do joelho

2) ClassificaÃ§Ã£o de Meyrs e McKeever
 Tipo 1 -> conservador 
 Tipo 2 -> tendÃªncia a tto conservador 
 Tipo 3 -> tendÃªncia a tto cirÃºrgico 
 Tipo 4 -> cirÃºrgico 

COMPLICAÃ‡Ã•ES  GERAIS 
(1) FÃªmur distal = Valgo
(2) TÃ­bia proximal = Valgo(Cozen)
   â€¢ melhora espontaneamente apÃ³s 4 anos da lesÃ£o(tto conservador)
   â€¢ interposiÃ§Ã£o da pata de ganso
(3) TÃ­bia diÃ¡fise = Varo
(4) Espinha da tÃ­bia = Perda da extensÃ£o 
(5) TAT = Recurvato",2025-12-01,,
1763849465874,1763845611548,Trauma Ped,Fraturas do fÃªmur,"HOT TOPICS ğŸ”¥ 
 â€¢ De uma maneira geral os nÃºmeros sÃ£o altos:
  - joelho flutuante a incidÃªncia de fraturas expostas chega a 60%
  - incidÃªncia de fraturas diafisarias chega a 70 %

FÃªmur Distal
1) Principal lesÃ£o associada: LCA

FÃªmur diÃ¡fise 
1) Tratamento(tipos e indicaÃ§Ãµes)
2) Desvantagens da haste com entrada pela fossa do piriforme: (1) fise aberta, (2)risco de fratura do colo e osteonecrose

FÃªmur Proximal
1) ClassificaÃ§Ã£o de DELBET e COLONNA: mais comum e mais grave",2025-11-30,,
1763999701838,1763941123114,Trauma Ped,fraturas da Bacia,"HOT TOPICS ğŸ”¥ 
1) ClassificaÃ§Ã£o de Torode e Zieg
  - fratura dos ramos pÃºbicos bilateral = tipo 4a
 - Anel pÃ©lvico Anterior Ã© 3A",2025-11-30,,
1764074226771,1764030788290,Joelho,Osteocondrite dissecante e LesÃµes condrais,"HOT TOPICS ğŸ”¥ 
Osteocondrite dissecante 
1) Epidemiologia 
2) LocalizaÃ§Ã£o 
3) Osteocondrite da patela: prognÃ³stico e localizaÃ§Ã£o 

LesÃµes condrais 
1) Tipos de tratamento",2025-11-25,,
1764118688167,1764075917874,Joelho,Menisco,"HOT TOPICS ğŸ”¥

1) LesÃ£o em RAMPA
 â€¢ Impacto posteromedial na tÃ­bia e no fÃªmur.
 â€¢ Mais comum",2025-11-29,,
1764363615850,1764363603942,Joelho,LesÃµes do LCA,"HOT TOPICS ğŸ”¥

1) DiferenÃ§as(vantagens e desvantagens) entre cada tipo de enxerto",2025-11-30,,
1764533467862,1764528772802,Joelho,ATJ e Gonartrose,"HOT TOPICS ğŸ”¥

ATJ
1) InfecÃ§Ã£o

2) A CONTRAINDICAÃ‡ÃƒO ABSOLUTA QUE ELES QUEREM: 
  -> DISFUNÃ‡ÃƒO DO MECANISMO EXTENSOR.

UNICOMPARTIMENTAL
7 ContraindicaÃ§Ãµes 

 OSTEOTOMIAS
6 ContraindicaÃ§Ãµes",2025-12-01,,`;

    // Parse CSV manual
    const lines = csv.split('\n').filter(l => l.trim());
    const headers = lines[0].split(',');
    
    // Encontrar Ã­ndices
    const idxId = headers.indexOf('id');
    const idxTemaId = headers.indexOf('temaId');
    const idxArea = headers.indexOf('area');
    const idxTema = headers.indexOf('tema');
    const idxConteudo = headers.indexOf('conteudo');
    const idxData = headers.indexOf('ultimaAtualizacao');
    
    console.log('Headers encontrados:', headers);
    console.log('Ãndices:', { idxId, idxTemaId, idxArea, idxTema, idxConteudo, idxData });
    
    // Parse rows (maneira simples para CSV com aspas)
    const rows = [];
    for (let i = 1; i < lines.length; i++) {
        const line = lines[i];
        const values = [];
        let current = '';
        let inQuotes = false;
        
        for (let j = 0; j < line.length; j++) {
            const ch = line[j];
            if (ch === '"') {
                if (inQuotes && line[j + 1] === '"') {
                    current += '"';
                    j++;
                } else {
                    inQuotes = !inQuotes;
                }
            } else if (ch === ',' && !inQuotes) {
                values.push(current.trim());
                current = '';
            } else {
                current += ch;
            }
        }
        values.push(current.trim());
        rows.push(values);
    }
    
    console.log(`Parseadas ${rows.length} linhas`);
    
    // Carregar dados existentes
    const dados = JSON.parse(localStorage.getItem('vrvs_dados') || '[]');
    let anotacoes = JSON.parse(localStorage.getItem('vrvs_anotacoes') || '[]');
    
    console.log(`Temas disponÃ­veis: ${dados.length}`);
    console.log(`AnotaÃ§Ãµes atuais: ${anotacoes.length}`);
    
    // Processar cada linha
    let recuperadas = 0;
    rows.forEach((row, i) => {
        try {
            const anotacao = {
                id: row[idxId] || Date.now() + i,
                temaId: String(row[idxTemaId] || ''),
                area: row[idxArea] || '',
                tema: row[idxTema] || '',
                conteudo: row[idxConteudo] || '',
                ultimaAtualizacao: row[idxData] || new Date().toISOString().split('T')[0]
            };
            
            // Remover aspas do conteÃºdo se houver
            if (anotacao.conteudo.startsWith('"') && anotacao.conteudo.endsWith('"')) {
                anotacao.conteudo = anotacao.conteudo.slice(1, -1);
            }
            
            // Verificar se temaId existe nos dados
            if (anotacao.temaId && anotacao.temaId.trim() !== '') {
                const temaExiste = dados.find(t => String(t.id) === anotacao.temaId);
                if (!temaExiste) {
                    console.warn(`âš ï¸ temaId ${anotacao.temaId} nÃ£o encontrado em dados para "${anotacao.tema}"`);
                    // Tentar encontrar pelo nome
                    const temaPorNome = dados.find(t => String(t.tema).trim() === String(anotacao.tema).trim());
                    if (temaPorNome) {
                        anotacao.temaId = String(temaPorNome.id);
                        console.log(`âœ… temaId encontrado pelo nome: ${anotacao.temaId}`);
                    }
                }
            } else if (anotacao.tema) {
                // Se nÃ£o tem temaId, tentar encontrar pelo nome
                const temaPorNome = dados.find(t => String(t.tema).trim() === String(anotacao.tema).trim());
                if (temaPorNome) {
                    anotacao.temaId = String(temaPorNome.id);
                    console.log(`âœ… temaId encontrado pelo nome: ${anotacao.temaId}`);
                }
            }
            
            // SÃ³ adicionar se tem conteÃºdo OU temaId vÃ¡lido
            if ((anotacao.conteudo && anotacao.conteudo.trim().length > 0) || (anotacao.temaId && anotacao.temaId.trim() !== '')) {
                // Verificar se jÃ¡ existe
                const existente = anotacoes.find(a => String(a.temaId) === String(anotacao.temaId) && anotacao.temaId);
                if (existente) {
                    // Atualizar se tem conteÃºdo
                    if (anotacao.conteudo && anotacao.conteudo.trim().length > 0) {
                        existente.conteudo = anotacao.conteudo;
                        existente.ultimaAtualizacao = anotacao.ultimaAtualizacao;
                        console.log(`ğŸ“ Atualizada: ${anotacao.tema}`);
                    }
                } else {
                    anotacoes.push(anotacao);
                    console.log(`â• Adicionada: ${anotacao.tema}`);
                }
                recuperadas++;
            }
        } catch (e) {
            console.error(`Erro na linha ${i + 2}:`, e);
        }
    });
    
    // Salvar
    localStorage.setItem('vrvs_anotacoes', JSON.stringify(anotacoes));
    
    console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.log(`âœ… ${recuperadas} anotaÃ§Ãµes processadas!`);
    console.log(`ğŸ’¾ Total de anotaÃ§Ãµes salvas: ${anotacoes.length}`);
    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.log('ğŸ”„ RECARREGUE A PÃGINA AGORA para ver as anotaÃ§Ãµes!');
    
    alert(`âœ… ${recuperadas} anotaÃ§Ãµes recuperadas!\n\nRecarregue a pÃ¡gina para ver.`);
})();

